# CDC（clock domain crossing）

CDC 跨时钟域处理



## 1. 单bit信号时钟域处理

### 1.1 慢时钟域的信号传输到快时钟域
1. 用`触发器打两拍`，降低亚稳态的影响
    -  限制条件：（data数据变化间隔）>（慢时钟域周期）+2*（快时钟域周期）+（路径延时）
    - 使用double flop来同步，有个最基本的“`3个沿`”要求，就是source data必须保证稳定不变至少碰见destination clock `3个连续的沿`，这个沿`可以是上升沿`也`可以是下降沿`，持续3个沿之后才能变，否则就有可能在destination clock domain根本看不到这个data的变化。
    - 脉冲宽度会改变，不影响同步结果


https://mp.weixin.qq.com/s/EULU3fmvtLQooBTkn5xHhA


### 1.2 快时钟域数据传输到慢时钟域
如果快时钟无法采集到慢时钟的脉冲变化


1. `脉冲展宽`+`打拍同步`
    - 那么将快时钟域的信号进行展宽，但是会出现毛刺
2. `脉动电平检测`+`双触发器同步`+`边缘检测`
    - 对快时钟域的电平设置检测信号（翻转）
    - 将翻转信号进行跨时钟域处理
    - 使用两次寄存器打节拍
    - 将两个寄存器信号做异或

3. `握手协议`

4. `脉冲同步`


# 亚稳态的工作量化指标

https://blog.csdn.net/qq_41300075/article/details/122482480


可用 MTBF（`Mean Time Between Failures`，故障平均时间）来定量描述亚稳态的实际影响，`MTBF`反应了一个系统稳定性程度，`MTBF`越大，意味着故障间隔时间越长，出现故障概率越低，即稳定性越高。
`MTBF`可由下式定量计算，$C_1$ 、$C_2$为器件常量，由工艺特性和环境条件决定。除了器件常量外，其他参数均与用户的设计有关，$f_{CLK}$和$f_{DATA}$分别为采样异步数据时的时钟频率和数据速率，$t_{MET}$为亚稳态输出后的稳定裕量时间，是指提前于`tco`的裕量，因此`tco`数值越大，显然亚稳态输出的不确定过程时间越短，工作越稳定，`MTBF`越大。
